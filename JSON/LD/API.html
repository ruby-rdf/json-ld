<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: JSON::LD::API
  
    &mdash; JSON-LD reader/writer for RDF.rb.
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "JSON::LD::API";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span>
     &raquo; 
    <span class="title">API</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: JSON::LD::API
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">JSON::LD::API</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Compact.html" title="JSON::LD::Compact (module)">Compact</a></span>, <span class='object_link'><a href="Expand.html" title="JSON::LD::Expand (module)">Expand</a></span>, <span class='object_link'><a href="Flatten.html" title="JSON::LD::Flatten (module)">Flatten</a></span>, <span class='object_link'><a href="Frame.html" title="JSON::LD::Frame (module)">Frame</a></span>, <span class='object_link'><a href="FromRDF.html" title="JSON::LD::FromRDF (module)">FromRDF</a></span>, <span class='object_link'><a href="ToRDF.html" title="JSON::LD::ToRDF (module)">ToRDF</a></span>, RDF::Util::Logger</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/json/ld/api.rb<span class="defines">,<br />
  lib/json/ld/html/rexml.rb,<br /> lib/json/ld/html/nokogiri.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A JSON-LD processor based on the JsonLdProcessor interface.</p>

<p>This API provides a clean mechanism that enables developers to convert JSON-LD data into a a variety of output formats that are easier to work with in various programming languages. If a JSON-LD API is provided in a programming environment, the entirety of the following API must be implemented.</p>

<p>Note that the API method signatures are somewhat different than what is specified, as the use of Futures and explicit callback parameters is not as relevant for Ruby-based interfaces.</p>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.w3.org/TR/json-ld11-api/#the-application-programming-interface" target="_parent" title="https://www.w3.org/TR/json-ld11-api/#the-application-programming-interface">https://www.w3.org/TR/json-ld11-api/#the-application-programming-interface</a></li>
    
  </ul>
<p class="tag_title">Author:</p>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p><a href="http://greggkellogg.net/">Gregg Kellogg</a></p>
</div>
      
    </li>
  
</ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="API/Nokogiri.html" title="JSON::LD::API::Nokogiri (module)">Nokogiri</a></span>, <span class='object_link'><a href="API/REXML.html" title="JSON::LD::API::REXML (module)">REXML</a></span>
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="OPEN_OPTS-constant" class="">OPEN_OPTS =
          <div class="docstring">
  <div class="discussion">
    
<p>Options used for open_file</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='label'>headers:</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Accept</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>application/ld+json, text/html;q=0.8, application/xhtml+xml;q=0.8, application/json;q=0.5</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="LINK_REL_CONTEXT-constant" class="">LINK_REL_CONTEXT =
          <div class="docstring">
  <div class="discussion">
    
<p>The following constants are used to reduce object allocations</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='tstring_content'>rel</span><span class='words_sep'> </span><span class='tstring_content'>http://www.w3.org/ns/json-ld#context</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="LINK_REL_ALTERNATE-constant" class="">LINK_REL_ALTERNATE =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='tstring_content'>rel</span><span class='words_sep'> </span><span class='tstring_content'>alternate</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="LINK_TYPE_JSONLD-constant" class="">LINK_TYPE_JSONLD =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='tstring_content'>type</span><span class='words_sep'> </span><span class='tstring_content'>application/ld+json</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="JSON_LD_PROCESSING_MODES-constant" class="">JSON_LD_PROCESSING_MODES =
          
        </dt>
        <dd><pre class="code"><span class='qwords_beg'>%w[</span><span class='tstring_content'>json-ld-1.0</span><span class='words_sep'> </span><span class='tstring_content'>json-ld-1.1</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  



  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Compact.html" title="JSON::LD::Compact (module)">Compact</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Compact.html#CONTAINER_MAPPING_LANGUAGE_INDEX_ID_TYPE-constant" title="JSON::LD::Compact::CONTAINER_MAPPING_LANGUAGE_INDEX_ID_TYPE (constant)">Compact::CONTAINER_MAPPING_LANGUAGE_INDEX_ID_TYPE</a></span>, <span class='object_link'><a href="Compact.html#EXPANDED_PROPERTY_DIRECTION_INDEX_LANGUAGE_VALUE-constant" title="JSON::LD::Compact::EXPANDED_PROPERTY_DIRECTION_INDEX_LANGUAGE_VALUE (constant)">Compact::EXPANDED_PROPERTY_DIRECTION_INDEX_LANGUAGE_VALUE</a></span></p>

  
  
  <h3 class="inherited">Constants included
     from <span class='object_link'><a href="Expand.html" title="JSON::LD::Expand (module)">Expand</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Expand.html#CONTAINER_INDEX_ID_TYPE-constant" title="JSON::LD::Expand::CONTAINER_INDEX_ID_TYPE (constant)">Expand::CONTAINER_INDEX_ID_TYPE</a></span>, <span class='object_link'><a href="Expand.html#KEYS_INCLUDED_TYPE_REVERSE-constant" title="JSON::LD::Expand::KEYS_INCLUDED_TYPE_REVERSE (constant)">Expand::KEYS_INCLUDED_TYPE_REVERSE</a></span>, <span class='object_link'><a href="Expand.html#KEYS_SET_LIST_INDEX-constant" title="JSON::LD::Expand::KEYS_SET_LIST_INDEX (constant)">Expand::KEYS_SET_LIST_INDEX</a></span>, <span class='object_link'><a href="Expand.html#KEYS_VALUE_LANGUAGE_TYPE_INDEX_DIRECTION-constant" title="JSON::LD::Expand::KEYS_VALUE_LANGUAGE_TYPE_INDEX_DIRECTION (constant)">Expand::KEYS_VALUE_LANGUAGE_TYPE_INDEX_DIRECTION</a></span>, <span class='object_link'><a href="Expand.html#KEY_ID-constant" title="JSON::LD::Expand::KEY_ID (constant)">Expand::KEY_ID</a></span></p>


  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  &#x21d2; JSON::LD::Context </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Input evaluation context.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#input-instance_method" title="#input (instance method)">#<strong>input</strong>  &#x21d2; String, ... </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current input.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#namer-instance_method" title="#namer (instance method)">#<strong>namer</strong>  &#x21d2; JSON::LD::BlankNodeNamer </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current Blank Node Namer.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#value-instance_method" title="#value (instance method)">#<strong>value</strong>  &#x21d2; String, ... </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current input.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#compact-class_method" title="compact (class method)">.<strong>compact</strong>(input, context, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; Object, Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Compacts the given input according to the steps in the Compaction Algorithm.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#documentLoader-class_method" title="documentLoader (class method)">.<strong>documentLoader</strong>(url, extractAllScripts: false, profile: nil, requestProfile: nil, **options) {|remote_document| ... } &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Default document loader.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expand-class_method" title="expand (class method)">.<strong>expand</strong>(input, framing: false, serializer: nil, **options) {|jsonld, base_iri| ... } &#x21d2; Object, Array&lt;Hash&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Expands the given input according to the steps in the Expansion Algorithm.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#flatten-class_method" title="flatten (class method)">.<strong>flatten</strong>(input, context, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; Object, Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This algorithm flattens an expanded JSON-LD document by collecting all properties of a node in a single JSON object and labeling all blank nodes with blank node identifiers.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#frame-class_method" title="frame (class method)">.<strong>frame</strong>(input, frame, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; Object, Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Frames the given input using the frame according to the steps in the Framing Algorithm.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fromRdf-class_method" title="fromRdf (class method)">.<strong>fromRdf</strong>(input, useRdfType: false, useNativeTypes: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; Object, Hash </a>
    

    
      (also: fromRDF)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take an ordered list of RDF::Statements and turn them into a JSON-LD document.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_html-class_method" title="load_html (class method)">.<strong>load_html</strong>(input, url:, library: nil, extractAllScripts: false, profile: nil, **options)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load one or more script tags from an HTML source.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#loadRemoteDocument-class_method" title="loadRemoteDocument (class method)">.<strong>loadRemoteDocument</strong>(url, allowed_content_types: nil, base: nil, documentLoader: nil, extractAllScripts: false, profile: nil, requestProfile: nil, validate: false, **options) {|remote_document| ... } &#x21d2; Object, RemoteDocument </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Uses built-in or provided documentLoader to retrieve a parsed document.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#serializer-class_method" title="serializer (class method)">.<strong>serializer</strong>(object, *_args, **options)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The default serializer for serialzing Ruby Objects to JSON.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#toRdf-class_method" title="toRdf (class method)">.<strong>toRdf</strong>(input, expanded: false, **options) {|statement| ... } &#x21d2; RDF::Enumerable </a>
    

    
      (also: toRDF)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Processes the input according to the RDF Conversion Algorithm, calling the provided callback for each triple generated.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate_input-class_method" title="validate_input (class method)">.<strong>validate_input</strong>(input, url:)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Validate JSON using JsonLint, if loaded.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Frame.html" title="JSON::LD::Frame (module)">Frame</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Frame.html#cleanup_null-instance_method" title="JSON::LD::Frame#cleanup_null (method)">#cleanup_null</a></span>, <span class='object_link'><a href="Frame.html#cleanup_preserve-instance_method" title="JSON::LD::Frame#cleanup_preserve (method)">#cleanup_preserve</a></span>, <span class='object_link'><a href="Frame.html#count_blank_node_identifiers-instance_method" title="JSON::LD::Frame#count_blank_node_identifiers (method)">#count_blank_node_identifiers</a></span>, <span class='object_link'><a href="Frame.html#count_blank_node_identifiers_internal-instance_method" title="JSON::LD::Frame#count_blank_node_identifiers_internal (method)">#count_blank_node_identifiers_internal</a></span>, <span class='object_link'><a href="Frame.html#frame-instance_method" title="JSON::LD::Frame#frame (method)">#frame</a></span>, <span class='object_link'><a href="Frame.html#prune_bnodes-instance_method" title="JSON::LD::Frame#prune_bnodes (method)">#prune_bnodes</a></span>, <span class='object_link'><a href="Frame.html#remove_dependents-instance_method" title="JSON::LD::Frame#remove_dependents (method)">#remove_dependents</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Utils.html" title="JSON::LD::Utils (module)">Utils</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Utils.html#add_value-instance_method" title="JSON::LD::Utils#add_value (method)">#add_value</a></span>, <span class='object_link'><a href="Utils.html#as_array-instance_method" title="JSON::LD::Utils#as_array (method)">#as_array</a></span>, <span class='object_link'><a href="Utils.html#as_resource-instance_method" title="JSON::LD::Utils#as_resource (method)">#as_resource</a></span>, <span class='object_link'><a href="Utils.html#blank_node%3F-instance_method" title="JSON::LD::Utils#blank_node? (method)">#blank_node?</a></span>, <span class='object_link'><a href="Utils.html#compare_values-instance_method" title="JSON::LD::Utils#compare_values (method)">#compare_values</a></span>, <span class='object_link'><a href="Utils.html#graph%3F-instance_method" title="JSON::LD::Utils#graph? (method)">#graph?</a></span>, <span class='object_link'><a href="Utils.html#has_value%3F-instance_method" title="JSON::LD::Utils#has_value? (method)">#has_value?</a></span>, <span class='object_link'><a href="Utils.html#index%3F-instance_method" title="JSON::LD::Utils#index? (method)">#index?</a></span>, <span class='object_link'><a href="Utils.html#list%3F-instance_method" title="JSON::LD::Utils#list? (method)">#list?</a></span>, <span class='object_link'><a href="Utils.html#node%3F-instance_method" title="JSON::LD::Utils#node? (method)">#node?</a></span>, <span class='object_link'><a href="Utils.html#node_or_ref%3F-instance_method" title="JSON::LD::Utils#node_or_ref? (method)">#node_or_ref?</a></span>, <span class='object_link'><a href="Utils.html#node_reference%3F-instance_method" title="JSON::LD::Utils#node_reference? (method)">#node_reference?</a></span>, <span class='object_link'><a href="Utils.html#property%3F-instance_method" title="JSON::LD::Utils#property? (method)">#property?</a></span>, <span class='object_link'><a href="Utils.html#simple_graph%3F-instance_method" title="JSON::LD::Utils#simple_graph? (method)">#simple_graph?</a></span>, <span class='object_link'><a href="Utils.html#value%3F-instance_method" title="JSON::LD::Utils#value? (method)">#value?</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="FromRDF.html" title="JSON::LD::FromRDF (module)">FromRDF</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="FromRDF.html#from_statements-instance_method" title="JSON::LD::FromRDF#from_statements (method)">#from_statements</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Flatten.html" title="JSON::LD::Flatten (module)">Flatten</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Flatten.html#create_annotations-instance_method" title="JSON::LD::Flatten#create_annotations (method)">#create_annotations</a></span>, <span class='object_link'><a href="Flatten.html#create_node_map-instance_method" title="JSON::LD::Flatten#create_node_map (method)">#create_node_map</a></span>, <span class='object_link'><a href="Flatten.html#rename_bnodes-instance_method" title="JSON::LD::Flatten#rename_bnodes (method)">#rename_bnodes</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="ToRDF.html" title="JSON::LD::ToRDF (module)">ToRDF</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ToRDF.html#item_to_rdf-instance_method" title="JSON::LD::ToRDF#item_to_rdf (method)">#item_to_rdf</a></span>, <span class='object_link'><a href="ToRDF.html#node-instance_method" title="JSON::LD::ToRDF#node (method)">#node</a></span>, <span class='object_link'><a href="ToRDF.html#parse_list-instance_method" title="JSON::LD::ToRDF#parse_list (method)">#parse_list</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Compact.html" title="JSON::LD::Compact (module)">Compact</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Compact.html#compact-instance_method" title="JSON::LD::Compact#compact (method)">#compact</a></span></p>

  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Expand.html" title="JSON::LD::Expand (module)">Expand</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Expand.html#expand-instance_method" title="JSON::LD::Expand#expand (method)">#expand</a></span></p>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="context=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="context-instance_method">
  
    #<strong>context</strong>  &#x21d2; <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Input evaluation context</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 58</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='ivar'>@context</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="input=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="input-instance_method">
  
    #<strong>input</strong>  &#x21d2; <tt>String</tt>, ... 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Current input</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 53</span>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:value</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="namer-instance_method">
  
    #<strong>namer</strong>  &#x21d2; <tt><span class='object_link'><a href="BlankNodeNamer.html" title="JSON::LD::BlankNodeNamer (class)">JSON::LD::BlankNodeNamer</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Current Blank Node Namer</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="BlankNodeNamer.html" title="JSON::LD::BlankNodeNamer (class)">JSON::LD::BlankNodeNamer</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_namer'>namer</span>
  <span class='ivar'>@namer</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="value=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="value-instance_method">
  
    #<strong>value</strong>  &#x21d2; <tt>String</tt>, ... 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Current input</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span>
  <span class='ivar'>@value</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="compact-class_method">
  
    .<strong>compact</strong>(input, context, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; <tt>Object</tt>, <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Compacts the given input according to the steps in the Compaction Algorithm. The input must be copied, compacted and returned if there are no errors. If the compaction fails, an appropirate exception must be thrown.</p>

<p>If no context is provided, the input document is compacted using the top-level context of the document</p>

<p>The resulting <code>Hash</code> is either returned or yielded, if a block is given.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD object to copy and perform the compaction upon.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The base context to use when compacting the input.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>serializer</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil) A Serializer instance used for generating the JSON serialization of the result. If absent, the internal Ruby objects are returned, which can be transformed to JSON externally via <code>#to_json</code>. See <span class='object_link'><a href="#serializer-class_method" title="JSON::LD::API.serializer (method)">serializer</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>expanded</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) Input is already expanded</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>jsonld</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>jsonld</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The compacted JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the compacted JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.w3.org/TR/json-ld11-api/#compaction-algorithm" target="_parent" title="https://www.w3.org/TR/json-ld11-api/#compaction-algorithm">https://www.w3.org/TR/json-ld11-api/#compaction-algorithm</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 235</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>compactToRelative:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='comment'># 1) Perform the Expansion Algorithm on the JSON-LD input.
</span>  <span class='comment'>#    This removes any existing context to allow the given context to be cleanly applied.
</span>  <span class='id identifier rubyid_expanded_input'>expanded_input</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_expanded'>expanded</span>
    <span class='id identifier rubyid_input'>input</span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_expand'><span class='object_link'><a href="#expand-class_method" title="JSON::LD::API.expand (method)">expand</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>ordered:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_base_iri'>base_iri</span><span class='op'>|</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_base_iri'>base_iri</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_base_iri'>base_iri</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:compactToRelative</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_res'>res</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_expanded_input'>expanded_input</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='label'>no_default_base:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># log_debug(&quot;.compact&quot;) {&quot;expanded input: #{expanded_input.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_compact'>compact</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>

    <span class='comment'># xxx) Add the given context to the output
</span>    <span class='id identifier rubyid_ctx'>ctx</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span><span class='lparen'>(</span><span class='label'>provided_context:</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_compact_iri'>compact_iri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>vocab:</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>?</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='op'>:</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_result'>result</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_ctx'>ctx</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_ctx'>ctx</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@context</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_serializer'>serializer</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_serializer'>serializer</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="documentLoader-class_method">
  
    .<strong>documentLoader</strong>(url, extractAllScripts: false, profile: nil, requestProfile: nil, **options) {|remote_document| ... } &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Default document loader.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>extractAllScripts</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>If set to <code>true</code>, when extracting JSON-LD script elements from HTML, unless a specific fragment identifier is targeted, extracts all encountered JSON-LD script elements using an array form, if necessary.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>profile</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>When the resulting <code>contentType</code> is <code>text/html</code> or <code>application/xhtml+xml</code>, this option determines the profile to use for selecting a JSON-LD script elements.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>requestProfile</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>One or more IRIs to use in the request as a profile parameter.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol =&gt; Object&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>remote_document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>remote_document</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></tt>, <tt>RDF::Util::File::RemoteDocument</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>IOError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 733</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_documentLoader'>documentLoader</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='label'>extractAllScripts:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>profile:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>requestProfile:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_url'>url</span>
  <span class='kw'>when</span> <span class='const'>IO</span><span class='comma'>,</span> <span class='const'>StringIO</span>
    <span class='id identifier rubyid_base_uri'>base_uri</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_base_uri'>base_uri</span> <span class='op'>||=</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_base_uri'>base_uri</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:base_uri</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:content_type</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>||=</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:content_type</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_context_url'>context_url</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:links</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span> <span class='op'>&amp;&amp;</span>
                     <span class='lparen'>(</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_content_type'>content_type</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>application/(^ld)+json</span><span class='regexp_end'>}</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_link'>link</span> <span class='op'>=</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_find_link'>find_link</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#LINK_REL_CONTEXT-constant" title="JSON::LD::API::LINK_REL_CONTEXT (constant)">LINK_REL_CONTEXT</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_link'>link</span><span class='op'>&amp;.</span><span class='id identifier rubyid_href'>href</span>
    <span class='kw'>end</span>

    <span class='kw'>yield</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="API/RemoteDocument.html#initialize-instance_method" title="JSON::LD::API::RemoteDocument#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='comma'>,</span>
      <span class='label'>documentUrl:</span> <span class='id identifier rubyid_base_uri'>base_uri</span><span class='comma'>,</span>
      <span class='label'>contentType:</span> <span class='id identifier rubyid_content_type'>content_type</span><span class='comma'>,</span>
      <span class='label'>contextUrl:</span> <span class='id identifier rubyid_context_url'>context_url</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'>Util</span><span class='op'>::</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open_file'>open_file</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expand-class_method">
  
    .<strong>expand</strong>(input, framing: false, serializer: nil, **options) {|jsonld, base_iri| ... } &#x21d2; <tt>Object</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Expands the given input according to the steps in the Expansion Algorithm. The input must be copied, expanded and returned if there are no errors. If the expansion fails, an appropriate exception must be thrown.</p>

<p>The resulting <code>Array</code> either returned or yielded</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD object to copy and perform the expansion upon.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>serializer</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil) A Serializer method used for generating the JSON serialization of the result. If absent, the internal Ruby objects are returned, which can be transformed to JSON externally via <code>#to_json</code>. See <span class='object_link'><a href="#serializer-class_method" title="JSON::LD::API.serializer (method)">serializer</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>jsonld, base_iri</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>jsonld</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The expanded JSON-LD document</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base_iri</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The document base as determined during expansion</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the expanded JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.w3.org/TR/json-ld11-api/#expansion-algorithm" target="_parent" title="https://www.w3.org/TR/json-ld11-api/#expansion-algorithm">https://www.w3.org/TR/json-ld11-api/#expansion-algorithm</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 183</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_expand'>expand</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>framing:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_doc_base'>doc_base</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:expandContext</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_expand'>expand</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span>
      <span class='label'>framing:</span> <span class='id identifier rubyid_framing'>framing</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_doc_base'>doc_base</span> <span class='op'>=</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:base</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># If, after the algorithm outlined above is run, the resulting element is an JSON object with just a @graph property, element is set to the value of @graph&#39;s value.
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Finally, if element is a JSON object, it is wrapped into an array.
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_result'>result</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span> <span class='kw'>unless</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_serializer'>serializer</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_serializer'>serializer</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_block'>block</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_arity'>arity</span>
    <span class='kw'>when</span> <span class='int'>1</span> <span class='kw'>then</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='int'>2</span> <span class='kw'>then</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_doc_base'>doc_base</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected number of yield parameters to expand</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="flatten-class_method">
  
    .<strong>flatten</strong>(input, context, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; <tt>Object</tt>, <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This algorithm flattens an expanded JSON-LD document by collecting all properties of a node in a single JSON object and labeling all blank nodes with blank node identifiers. This resulting uniform shape of the document, may drastically simplify the code required to process JSON-LD data in certain applications.</p>

<p>The resulting <code>Array</code> is either returned, or yielded if a block is given.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD object or array of JSON-LD objects to flatten or an IRI referencing the JSON-LD document to flatten.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt>JSON::LD::EvaluationContext</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An optional external context to use additionally to the context embedded in input when expanding the input.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>expanded</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) Input is already expanded</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>serializer</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil) A Serializer instance used for generating the JSON serialization of the result. If absent, the internal Ruby objects are returned, which can be transformed to JSON externally via <code>#to_json</code>. See <span class='object_link'><a href="#serializer-class_method" title="JSON::LD::API.serializer (method)">serializer</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:createAnnotations</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Unfold embedded nodes which can be represented using <code>@annotation</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>jsonld</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>jsonld</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The flattened JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the flattened JSON-LD document</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.w3.org/TR/json-ld11-api/#framing-algorithm" target="_parent" title="https://www.w3.org/TR/json-ld11-api/#framing-algorithm">https://www.w3.org/TR/json-ld11-api/#framing-algorithm</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 290</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_flattened'>flattened</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>compactToRelative:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>extractAllScripts:</span> <span class='kw'>true</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='comment'># Expand input to simplify processing
</span>  <span class='id identifier rubyid_expanded_input'>expanded_input</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_expanded'>expanded</span>
    <span class='id identifier rubyid_input'>input</span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_expand'><span class='object_link'><a href="#expand-class_method" title="JSON::LD::API.expand (method)">expand</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_base_iri'>base_iri</span><span class='op'>|</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_base_iri'>base_iri</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_base_iri'>base_iri</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:compactToRelative</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_result'>result</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Initialize input using
</span>  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_expanded_input'>expanded_input</span><span class='comma'>,</span> <span class='id identifier rubyid_context'>context</span><span class='comma'>,</span> <span class='label'>no_default_base:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># log_debug(&quot;.flatten&quot;) {&quot;expanded input: #{value.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>
    <span class='comment'># Rename blank nodes recusively. Note that this does not create new blank node identifiers where none exist, which is performed in the node map generation algorithm.
</span>    <span class='ivar'>@value</span> <span class='op'>=</span> <span class='id identifier rubyid_rename_bnodes'>rename_bnodes</span><span class='lparen'>(</span><span class='ivar'>@value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:rename_bnodes</span><span class='rbracket'>]</span>

    <span class='comment'># Initialize node map to a JSON object consisting of a single member whose key is @default and whose value is an empty JSON object.
</span>    <span class='id identifier rubyid_graph_maps'>graph_maps</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@default</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_create_node_map'>create_node_map</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_graph_maps'>graph_maps</span><span class='rparen'>)</span>

    <span class='comment'># If create annotations flag is set, then update each node map in graph maps with the result of calling the create annotations algorithm.
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:createAnnotations</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_graph_maps'>graph_maps</span><span class='period'>.</span><span class='id identifier rubyid_each_value'>each_value</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_node_map'>node_map</span><span class='op'>|</span>
        <span class='id identifier rubyid_create_annotations'>create_annotations</span><span class='lparen'>(</span><span class='id identifier rubyid_node_map'>node_map</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_default_graph'>default_graph</span> <span class='op'>=</span> <span class='id identifier rubyid_graph_maps'>graph_maps</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@default</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_graph_maps'>graph_maps</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_opt_sort'>opt_sort</span><span class='lparen'>(</span><span class='label'>ordered:</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:ordered</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_graph_name'>graph_name</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_graph_name'>graph_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@default</span><span class='tstring_end'>&#39;</span></span>

      <span class='id identifier rubyid_graph'>graph</span> <span class='op'>=</span> <span class='id identifier rubyid_graph_maps'>graph_maps</span><span class='lbracket'>[</span><span class='id identifier rubyid_graph_name'>graph_name</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_entry'>entry</span> <span class='op'>=</span> <span class='id identifier rubyid_default_graph'>default_graph</span><span class='lbracket'>[</span><span class='id identifier rubyid_graph_name'>graph_name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@id</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_graph_name'>graph_name</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_nodes'>nodes</span> <span class='op'>=</span> <span class='id identifier rubyid_entry'>entry</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_graph'>graph</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_opt_sort'>opt_sort</span><span class='lparen'>(</span><span class='label'>ordered:</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:ordered</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
        <span class='id identifier rubyid_nodes'>nodes</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_graph'>graph</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_node_reference?'>node_reference?</span><span class='lparen'>(</span><span class='id identifier rubyid_graph'>graph</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_default_graph'>default_graph</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_opt_sort'>opt_sort</span><span class='lparen'>(</span><span class='label'>ordered:</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:ordered</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_id'>id</span><span class='op'>|</span>
      <span class='id identifier rubyid_flattened'>flattened</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_default_graph'>default_graph</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_node_reference?'>node_reference?</span><span class='lparen'>(</span><span class='id identifier rubyid_default_graph'>default_graph</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_context'>context</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_flattened'>flattened</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='comment'># Otherwise, return the result of compacting flattened according the Compaction algorithm passing context ensuring that the compaction result uses the @graph keyword (or its alias) at the top-level, even if the context is empty or if there is only one element to put in the @graph array. This ensures that the returned document has a deterministic structure.
</span>      <span class='id identifier rubyid_compacted'>compacted</span> <span class='op'>=</span> <span class='id identifier rubyid_as_array'>as_array</span><span class='lparen'>(</span><span class='id identifier rubyid_compact'>compact</span><span class='lparen'>(</span><span class='id identifier rubyid_flattened'>flattened</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_compact_iri'>compact_iri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>vocab:</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_flattened'>flattened</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_context'>context</span>
        <span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span><span class='lparen'>(</span><span class='label'>provided_context:</span> <span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
        <span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_compacted'>compacted</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_flattened'>flattened</span> <span class='op'>=</span> <span class='id identifier rubyid_serializer'>serializer</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_flattened'>flattened</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_serializer'>serializer</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_flattened'>flattened</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_flattened'>flattened</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="frame-class_method">
  
    .<strong>frame</strong>(input, frame, expanded: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; <tt>Object</tt>, <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Frames the given input using the frame according to the steps in the Framing Algorithm. The input is used to build the framed output and is returned if there are no errors. If there are no matches for the frame, null must be returned. Exceptions must be thrown if there are errors.</p>

<p>The resulting <code>Array</code> is either returned, or yielded if a block is given.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD object to copy and perform the framing on.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>frame</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The frame to use when re-arranging the data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>expanded</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) Input is already expanded</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:embed</span>
          <span class="type">(<tt>'@always'</tt>, <tt>'@link'</tt>, <tt>'@once'</tt>, <tt>'@never'</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>&#39;@once&#39;</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>a flag specifying that objects should be directly embedded in the output, instead of being referred to by their IRI.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:explicit</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>a flag specifying that for properties to be included in the output, they must be explicitly declared in the framing context.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:requireAll</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>A flag specifying that all properties present in the input frame must either have a default value or be present in the JSON-LD input for the frame to match.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:omitDefault</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>a flag specifying that properties that are missing from the JSON-LD input should be omitted from the output.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:pruneBlankNodeIdentifiers</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>removes blank node identifiers that are only used once.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:omitGraph</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>does not use <code>@graph</code> at top level unless necessary to describe multiple objects, defaults to <code>true</code> if processingMode is 1.1, otherwise <code>false</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>jsonld</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>jsonld</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The framed JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the framed JSON-LD document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>InvalidFrame</tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://www.w3.org/TR/json-ld11-api/#framing-algorithm" target="_parent" title="https://www.w3.org/TR/json-ld11-api/#framing-algorithm">https://www.w3.org/TR/json-ld11-api/#framing-algorithm</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 383</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_frame'>frame</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_frame'>frame</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>base:</span> <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>compactArrays:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>compactToRelative:</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='label'>embed:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@once</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>explicit:</span> <span class='kw'>false</span><span class='comma'>,</span>
    <span class='label'>requireAll:</span> <span class='kw'>false</span><span class='comma'>,</span>
    <span class='label'>omitDefault:</span> <span class='kw'>false</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_framing_state'>framing_state</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>graphMap:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>graphStack:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>subjectStack:</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>link:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>embedded:</span> <span class='kw'>false</span> <span class='comment'># False at the top-level
</span>  <span class='rbrace'>}</span>

  <span class='comment'># de-reference frame to create the framing object
</span>  <span class='id identifier rubyid_frame'>frame</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_frame'>frame</span>
  <span class='kw'>when</span> <span class='const'>Hash</span> <span class='kw'>then</span> <span class='id identifier rubyid_frame'>frame</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='kw'>when</span> <span class='const'>IO</span><span class='comma'>,</span> <span class='const'>StringIO</span><span class='comma'>,</span> <span class='const'>String</span>
    <span class='id identifier rubyid_remote_doc'>remote_doc</span> <span class='op'>=</span> <span class='id identifier rubyid_loadRemoteDocument'>loadRemoteDocument</span><span class='lparen'>(</span><span class='id identifier rubyid_frame'>frame</span><span class='comma'>,</span>
      <span class='label'>profile:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://www.w3.org/ns/json-ld#frame</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='label'>requestProfile:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://www.w3.org/ns/json-ld#frame</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                                    <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_mj_opts'>mj_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:adapter</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../LD.html#MUTLI_JSON_ADAPTERS-constant" title="JSON::LD::MUTLI_JSON_ADAPTERS (constant)">MUTLI_JSON_ADAPTERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_mj_opts'>mj_opts</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Expand input to simplify processing
</span>  <span class='id identifier rubyid_expanded_input'>expanded_input</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_expanded'>expanded</span>
    <span class='id identifier rubyid_input'>input</span>
  <span class='kw'>else</span>
    <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_expand'><span class='object_link'><a href="#expand-class_method" title="JSON::LD::API.expand (method)">expand</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>ordered:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='comma'>,</span> <span class='id identifier rubyid_base_iri'>base_iri</span><span class='op'>|</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:base</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_base_iri'>base_iri</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_base_iri'>base_iri</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:compactToRelative</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_res'>res</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Expand frame to simplify processing
</span>  <span class='id identifier rubyid_expanded_frame'>expanded_frame</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_expand'><span class='object_link'><a href="#expand-class_method" title="JSON::LD::API.expand (method)">expand</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_frame'>frame</span><span class='comma'>,</span> <span class='label'>framing:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>ordered:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='comment'># Initialize input using frame as context
</span>  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_expanded_input'>expanded_input</span><span class='comma'>,</span> <span class='id identifier rubyid_frame'>frame</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@context</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>no_default_base:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># log_debug(&quot;.frame&quot;) {&quot;expanded input: #{expanded_input.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>    <span class='comment'># log_debug(&quot;.frame&quot;) {&quot;expanded frame: #{expanded_frame.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>
    <span class='kw'>if</span> <span class='qwords_beg'>%w[</span><span class='tstring_content'>@first</span><span class='words_sep'> </span><span class='tstring_content'>@last</span><span class='tstring_end'>]</span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:embed</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_processingMode'>processingMode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>json-ld-1.1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:validate</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/InvalidEmbedValue.html" title="JSON::LD::JsonLdError::InvalidEmbedValue (class)">InvalidEmbedValue</a></span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:embed</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not a valid value of @embed in 1.1 mode</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_warn'>warn</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[DEPRECATION] </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:embed</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>  is not a valid value of @embed in 1.1 mode.\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Set omitGraph option, if not present, based on processingMode
</span>    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:omitGraph</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_processingMode'>processingMode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>json-ld-1.1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:omitGraph</span><span class='rparen'>)</span>

    <span class='comment'># Rename blank nodes recusively. Note that this does not create new blank node identifiers where none exist, which is performed in the node map generation algorithm.
</span>    <span class='ivar'>@value</span> <span class='op'>=</span> <span class='id identifier rubyid_rename_bnodes'>rename_bnodes</span><span class='lparen'>(</span><span class='ivar'>@value</span><span class='rparen'>)</span>

    <span class='comment'># Get framing nodes from expanded input, replacing Blank Node identifiers as necessary
</span>    <span class='id identifier rubyid_create_node_map'>create_node_map</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graphMap</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>active_graph:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@default</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_frame_keys'>frame_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_frame'>frame</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_expand_iri'>expand_iri</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='label'>vocab:</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_frame_keys'>frame_keys</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='comment'># If frame contains @graph, it matches the default graph.
</span>      <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graph</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@default</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>else</span>
      <span class='comment'># If frame does not contain @graph used the merged graph.
</span>      <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graph</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@merged</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:link</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@merged</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graphMap</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@merged</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_merge_node_map_graphs'>merge_node_map_graphs</span><span class='lparen'>(</span><span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graphMap</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:subjects</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graphMap</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:graph</span><span class='rbracket'>]</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_frame'>frame</span><span class='lparen'>(</span><span class='id identifier rubyid_framing_state'>framing_state</span><span class='comma'>,</span> <span class='id identifier rubyid_framing_state'>framing_state</span><span class='lbracket'>[</span><span class='symbol'>:subjects</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_opt_sort'>opt_sort</span><span class='lparen'>(</span><span class='label'>ordered:</span> <span class='ivar'>@options</span><span class='lbracket'>[</span><span class='symbol'>:ordered</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_expanded_frame'>expanded_frame</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>parent:</span> <span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

    <span class='comment'># Default to based on processinMode
</span>    <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='symbol'>:pruneBlankNodeIdentifiers</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:pruneBlankNodeIdentifiers</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_processingMode'>processingMode</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>json-ld-1.1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Count blank node identifiers used in the document, if pruning
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:pruneBlankNodeIdentifiers</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_bnodes_to_clear'>bnodes_to_clear</span> <span class='op'>=</span> <span class='id identifier rubyid_count_blank_node_identifiers'>count_blank_node_identifiers</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='kw'>if</span> <span class='id identifier rubyid_v'>v</span> <span class='op'>==</span> <span class='int'>1</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
      <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_prune_bnodes'>prune_bnodes</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='id identifier rubyid_bnodes_to_clear'>bnodes_to_clear</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># Replace values with `@preserve` with the content of its entry.
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_cleanup_preserve'>cleanup_preserve</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
    <span class='comment'># log_debug(&quot;.frame&quot;) {&quot;expanded result: #{result.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>
    <span class='comment'># Compact result
</span>    <span class='id identifier rubyid_compacted'>compacted</span> <span class='op'>=</span> <span class='id identifier rubyid_compact'>compact</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>

    <span class='comment'># @replace `@null` with nil, compacting arrays
</span>    <span class='id identifier rubyid_compacted'>compacted</span> <span class='op'>=</span> <span class='id identifier rubyid_cleanup_null'>cleanup_null</span><span class='lparen'>(</span><span class='id identifier rubyid_compacted'>compacted</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_compacted'>compacted</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_compacted'>compacted</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:omitGraph</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_compacted'>compacted</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>

    <span class='comment'># Add the given context to the output
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_compacted'>compacted</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_compact_iri'>compact_iri</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@graph</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>vocab:</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='lbrace'>{</span> <span class='id identifier rubyid_kwgraph'>kwgraph</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_compacted'>compacted</span> <span class='rbrace'>}</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_compacted'>compacted</span>
    <span class='kw'>end</span>
    <span class='comment'># Only add context if one was provided
</span>    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_serialize'>serialize</span><span class='lparen'>(</span><span class='label'>provided_context:</span> <span class='id identifier rubyid_frame'>frame</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_frame'>frame</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@context</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

    <span class='comment'># log_debug(&quot;.frame&quot;) {&quot;after compact: #{result.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_serializer'>serializer</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_serializer'>serializer</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fromRdf-class_method">
  
    .<strong>fromRdf</strong>(input, useRdfType: false, useNativeTypes: false, serializer: nil, **options) {|jsonld| ... } &#x21d2; <tt>Object</tt>, <tt>Hash</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='fromRDF-class_method'>fromRDF</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take an ordered list of RDF::Statements and turn them into a JSON-LD document.</p>

<p>The resulting <code>Array</code> is either returned or yielded, if a block is given.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>RDF::Enumerable</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>useRdfType</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) If set to <code>true</code>, the JSON-LD processor will treat <code>rdf:type</code> like a normal property instead of using <code>@type</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>useNativeTypes</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) use native representations</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>serializer</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil) A Serializer instance used for generating the JSON serialization of the result. If absent, the internal Ruby objects are returned, which can be transformed to JSON externally via <code>#to_json</code>. See <span class='object_link'><a href="#serializer-class_method" title="JSON::LD::API.serializer (method)">serializer</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>jsonld</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>jsonld</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD document in expanded form</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the expanded JSON-LD document</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


584
585
586
587
588
589
590
591
592
593
594
595
596</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 584</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_fromRdf'>fromRdf</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>useRdfType:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>useNativeTypes:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>serializer:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_from_statements'>from_statements</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span>
      <span class='label'>extendedRepresentation:</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:extendedRepresentation</span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='label'>useRdfType:</span> <span class='id identifier rubyid_useRdfType'>useRdfType</span><span class='comma'>,</span>
      <span class='label'>useNativeTypes:</span> <span class='id identifier rubyid_useNativeTypes'>useNativeTypes</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_serializer'>serializer</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_serializer'>serializer</span>
  <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_html-class_method">
  
    .<strong>load_html</strong>(input, url:, library: nil, extractAllScripts: false, profile: nil, **options)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load one or more script tags from an HTML source. Unescapes and uncomments input, returns the internal representation Yields document base</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Original URL</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>library</span>
      
      
        <span class='type'>(<tt>:nokogiri</tt>, <tt>:rexml</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>extractAllScripts</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>profile</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(nil) Optional priortized profile when loading a single script by type.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash{Symbol =&gt; Object}</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 771</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_load_html'>load_html</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>url:</span><span class='comma'>,</span>
                   <span class='label'>library:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                   <span class='label'>extractAllScripts:</span> <span class='kw'>false</span><span class='comma'>,</span>
                   <span class='label'>profile:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                   <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_library'>library</span> <span class='op'>||=</span> <span class='kw'>begin</span>
      <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>nokogiri</span><span class='tstring_end'>&#39;</span></span>
      <span class='symbol'>:nokogiri</span>
    <span class='kw'>rescue</span> <span class='const'>LoadError</span>
      <span class='symbol'>:rexml</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>json/ld/html/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_library'>library</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='comment'># Parse HTML using the appropriate library
</span>    <span class='id identifier rubyid_implementation'>implementation</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_library'>library</span>
    <span class='kw'>when</span> <span class='symbol'>:nokogiri</span> <span class='kw'>then</span> <span class='const'><span class='object_link'><a href="API/Nokogiri.html" title="JSON::LD::API::Nokogiri (module)">Nokogiri</a></span></span>
    <span class='kw'>when</span> <span class='symbol'>:rexml</span> <span class='kw'>then</span> <span class='const'><span class='object_link'><a href="API/REXML.html" title="JSON::LD::API::REXML (module)">REXML</a></span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='id identifier rubyid_implementation'>implementation</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='kw'>begin</span>
      <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>initialize_html_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_library'>library</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>StandardError</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Malformed HTML document: </span><span class='embexpr_beg'>#{</span><span class='gvar'>$ERROR_INFO</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Potentially update options[:base]
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_html_base'>html_base</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_at_xpath'>at_xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/html/head/base/@href</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_base'>base</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span>
      <span class='id identifier rubyid_html_base'>html_base</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_html_base'>html_base</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_html_base'>html_base</span> <span class='op'>=</span> <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_html_base'>html_base</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span>
      <span class='kw'>yield</span> <span class='id identifier rubyid_html_base'>html_base</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_url'>url</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_fragment'>fragment</span>
    <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='const'>CGI</span><span class='period'>.</span><span class='id identifier rubyid_unescape'>unescape</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='period'>.</span><span class='id identifier rubyid_fragment'>fragment</span><span class='rparen'>)</span>
    <span class='comment'># Find script with an ID based on that fragment.
</span>    <span class='id identifier rubyid_element'>element</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_at_xpath'>at_xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[@id=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No script tag found with id=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_id'>id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_element'>element</span>

    <span class='kw'>unless</span> <span class='id identifier rubyid_element'>element</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/ld+json</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Script tag has type=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_element'>element</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>type</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='id identifier rubyid_element'>element</span><span class='period'>.</span><span class='id identifier rubyid_inner_html'>inner_html</span>
    <span class='id identifier rubyid_validate_input'>validate_input</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='label'>url:</span> <span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:validate</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_mj_opts'>mj_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:adapter</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../LD.html#MUTLI_JSON_ADAPTERS-constant" title="JSON::LD::MUTLI_JSON_ADAPTERS (constant)">MUTLI_JSON_ADAPTERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_mj_opts'>mj_opts</span><span class='rparen'>)</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_extractAllScripts'>extractAllScripts</span>
    <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_elements'>elements</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_profile'>profile</span>
      <span class='id identifier rubyid_es'>es</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[starts-with(@type, &#39;application/ld+json;profile=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_profile'>profile</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='comment'># If no profile script, just take a single script without profile
</span>      <span class='id identifier rubyid_es'>es</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_at_xpath'>at_xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[starts-with(@type, &#39;application/ld+json&#39;)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span> <span class='kw'>if</span> <span class='id identifier rubyid_es'>es</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_es'>es</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_xpath'>xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[starts-with(@type, &#39;application/ld+json&#39;)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span>
      <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='id identifier rubyid_element'>element</span><span class='period'>.</span><span class='id identifier rubyid_inner_html'>inner_html</span>
      <span class='id identifier rubyid_validate_input'>validate_input</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='label'>url:</span> <span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:validate</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_mj_opts'>mj_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:adapter</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../LD.html#MUTLI_JSON_ADAPTERS-constant" title="JSON::LD::MUTLI_JSON_ADAPTERS (constant)">MUTLI_JSON_ADAPTERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='id identifier rubyid_r'>r</span> <span class='op'>=</span> <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_mj_opts'>mj_opts</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_res'>res</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_r'>r</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_r'>r</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_concat'>concat</span><span class='lparen'>(</span><span class='id identifier rubyid_r'>r</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_res'>res</span>
  <span class='kw'>else</span>
    <span class='comment'># Find the first script with type application/ld+json.
</span>    <span class='id identifier rubyid_element'>element</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_at_xpath'>at_xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[starts-with(@type, &#39;application/ld+json;profile=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_profile'>profile</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_profile'>profile</span>
    <span class='id identifier rubyid_element'>element</span> <span class='op'>||=</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_at_xpath'>at_xpath</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>//script[starts-with(@type, &#39;application/ld+json&#39;)]</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No script tag found</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_element'>element</span>

    <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='id identifier rubyid_element'>element</span><span class='period'>.</span><span class='id identifier rubyid_inner_html'>inner_html</span>
    <span class='id identifier rubyid_validate_input'>validate_input</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='label'>url:</span> <span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:validate</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_mj_opts'>mj_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:adapter</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../LD.html#MUTLI_JSON_ADAPTERS-constant" title="JSON::LD::MUTLI_JSON_ADAPTERS (constant)">MUTLI_JSON_ADAPTERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_mj_opts'>mj_opts</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>MultiJson</span><span class='op'>::</span><span class='const'>ParseError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/InvalidScriptElement.html" title="JSON::LD::JsonLdError::InvalidScriptElement (class)">InvalidScriptElement</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="loadRemoteDocument-class_method">
  
    .<strong>loadRemoteDocument</strong>(url, allowed_content_types: nil, base: nil, documentLoader: nil, extractAllScripts: false, profile: nil, requestProfile: nil, validate: false, **options) {|remote_document| ... } &#x21d2; <tt>Object</tt>, <tt><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Uses built-in or provided documentLoader to retrieve a parsed document.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>allowed_content_types</span>
      
      
        <span class='type'>(<tt>Regexp</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A regular expression matching other content types allowed beyond types for JSON and HTML.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>base</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Location to use as documentUrl instead of <code>url</code>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>extractAllScripts</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>If set to <code>true</code>, when extracting JSON-LD script elements from HTML, unless a specific fragment identifier is targeted, extracts all encountered JSON-LD script elements using an array form, if necessary.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>profile</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>When the resulting <code>contentType</code> is <code>text/html</code> or <code>application/xhtml+xml</code>, this option determines the profile to use for selecting a JSON-LD script elements.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>requestProfile</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>One or more IRIs to use in the request as a profile parameter.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>validate</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) Allow only appropriate content types</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol =&gt; Object&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>remote_document</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>remote_document</span>
      
      
        <span class='type'>(<tt>RemoteDocumentRemoteDocument</tt>, <tt>RDF::Util::File::RemoteDocument</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>returned object</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>If a block is given, the result of evaluating the block is returned, otherwise, the retrieved remote document and context information unless block given</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714
715
716
717
718</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 624</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_loadRemoteDocument'>loadRemoteDocument</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span>
                            <span class='label'>allowed_content_types:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                            <span class='label'>base:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                            <span class='label'>documentLoader:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                            <span class='label'>extractAllScripts:</span> <span class='kw'>false</span><span class='comma'>,</span>
                            <span class='label'>profile:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                            <span class='label'>requestProfile:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                            <span class='label'>validate:</span> <span class='kw'>false</span><span class='comma'>,</span>
                            <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_documentLoader'>documentLoader</span> <span class='op'>||=</span> <span class='id identifier rubyid_method'>method</span><span class='lparen'>(</span><span class='symbol'>:documentLoader</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#OPEN_OPTS-constant" title="JSON::LD::API::OPEN_OPTS (constant)">OPEN_OPTS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_requestProfile'>requestProfile</span>
    <span class='comment'># Add any request profile
</span>    <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:headers</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Accept</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span>
      <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:headers</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Accept</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/ld+json,</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>application/ld+json;profile=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_requestProfile'>requestProfile</span><span class='embexpr_end'>}</span><span class='tstring_content'>, application/ld+json;q=0.9,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_documentLoader'>documentLoader</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'>Util</span><span class='op'>::</span><span class='const'>File</span><span class='op'>::</span><span class='const'>RemoteDocument</span>
      <span class='comment'># Convert to RemoteDocument
</span>      <span class='id identifier rubyid_context_url'>context_url</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/ld+json</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span>
                       <span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/json</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span>
                        <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>application/\w+\+json</span><span class='regexp_end'>}</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='comment'># Get context link(s)
</span>        <span class='comment'># Note, we can&#39;t simply use #find_link, as we need to detect multiple
</span>        <span class='id identifier rubyid_links'>links</span> <span class='op'>=</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_link'>link</span><span class='op'>|</span>
          <span class='id identifier rubyid_link'>link</span><span class='period'>.</span><span class='id identifier rubyid_attr_pairs'>attr_pairs</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#LINK_REL_CONTEXT-constant" title="JSON::LD::API::LINK_REL_CONTEXT (constant)">LINK_REL_CONTEXT</a></span></span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/MultipleContextLinkHeaders.html" title="JSON::LD::JsonLdError::MultipleContextLinkHeaders (class)">MultipleContextLinkHeaders</a></span></span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected at most 1 Link header with rel=jsonld:context, got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='const'><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span>

      <span class='comment'># If content-type is not application/ld+json, nor any other +json and a link with rel=alternate and type=&#39;application/ld+json&#39; is found, use that instead
</span>      <span class='id identifier rubyid_alternate'>alternate</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>application/(\w*\+)?json</span><span class='regexp_end'>}</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_links'>links</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_link'>link</span><span class='op'>|</span>
        <span class='id identifier rubyid_link'>link</span><span class='period'>.</span><span class='id identifier rubyid_attr_pairs'>attr_pairs</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#LINK_REL_ALTERNATE-constant" title="JSON::LD::API::LINK_REL_ALTERNATE (constant)">LINK_REL_ALTERNATE</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
          <span class='id identifier rubyid_link'>link</span><span class='period'>.</span><span class='id identifier rubyid_attr_pairs'>attr_pairs</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="#LINK_TYPE_JSONLD-constant" title="JSON::LD::API::LINK_TYPE_JSONLD (constant)">LINK_TYPE_JSONLD</a></span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_remote_doc'>remote_doc</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_alternate'>alternate</span>
        <span class='comment'># Load alternate relative to URL
</span>        <span class='id identifier rubyid_loadRemoteDocument'>loadRemoteDocument</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">URI</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_url'>url</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_alternate'>alternate</span><span class='period'>.</span><span class='id identifier rubyid_href'>href</span><span class='rparen'>)</span><span class='comma'>,</span>
          <span class='label'>extractAllScripts:</span> <span class='id identifier rubyid_extractAllScripts'>extractAllScripts</span><span class='comma'>,</span>
          <span class='label'>profile:</span> <span class='id identifier rubyid_profile'>profile</span><span class='comma'>,</span>
          <span class='label'>requestProfile:</span> <span class='id identifier rubyid_requestProfile'>requestProfile</span><span class='comma'>,</span>
          <span class='label'>validate:</span> <span class='id identifier rubyid_validate'>validate</span><span class='comma'>,</span>
          <span class='label'>base:</span> <span class='id identifier rubyid_base'>base</span><span class='comma'>,</span>
            <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='const'><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="API/RemoteDocument.html#initialize-instance_method" title="JSON::LD::API::RemoteDocument#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='comma'>,</span>
          <span class='label'>documentUrl:</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_base_uri'>base_uri</span><span class='comma'>,</span>
          <span class='label'>contentType:</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_content_type'>content_type</span><span class='comma'>,</span>
          <span class='label'>contextUrl:</span> <span class='id identifier rubyid_context_url'>context_url</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="API/RemoteDocument.html" title="JSON::LD::API::RemoteDocument (class)">RemoteDocument</a></span></span>
      <span class='comment'># Pass through
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unknown result from documentLoader: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='comment'># Use specified document location
</span>    <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_documentUrl'>documentUrl</span> <span class='op'>=</span> <span class='id identifier rubyid_base'>base</span> <span class='kw'>if</span> <span class='id identifier rubyid_base'>base</span>

    <span class='comment'># Parse any HTML
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span> <span class='op'>=</span> <span class='kw'>case</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_contentType'>contentType</span>
      <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/html</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>application/xhtml+xml</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_load_html'>load_html</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='comma'>,</span>
          <span class='label'>url:</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_documentUrl'>documentUrl</span><span class='comma'>,</span>
          <span class='label'>extractAllScripts:</span> <span class='id identifier rubyid_extractAllScripts'>extractAllScripts</span><span class='comma'>,</span>
          <span class='label'>profile:</span> <span class='id identifier rubyid_profile'>profile</span><span class='comma'>,</span>
                  <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_base'>base</span><span class='op'>|</span>
          <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_documentUrl'>documentUrl</span> <span class='op'>=</span> <span class='id identifier rubyid_base'>base</span>
        <span class='kw'>end</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_validate_input'>validate_input</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='label'>url:</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_documentUrl'>documentUrl</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_validate'>validate</span>
        <span class='id identifier rubyid_mj_opts'>mj_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_keep_if'>keep_if</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>!=</span> <span class='symbol'>:adapter</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="../LD.html#MUTLI_JSON_ADAPTERS-constant" title="JSON::LD::MUTLI_JSON_ADAPTERS (constant)">MUTLI_JSON_ADAPTERS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
        <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_document'>document</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_mj_opts'>mj_opts</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_contentType'>contentType</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_validate'>validate</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_contentType'>contentType</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>application/(.+\+)?json|text/html|application/xhtml\+xml</span><span class='regexp_end'>}</span></span><span class='rparen'>)</span> <span class='op'>||</span>
        <span class='lparen'>(</span><span class='id identifier rubyid_allowed_content_types'>allowed_content_types</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_contentType'>contentType</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='id identifier rubyid_allowed_content_types'>allowed_content_types</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>IOError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>, contentType: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='period'>.</span><span class='id identifier rubyid_contentType'>contentType</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_block_given?'>block_given?</span> <span class='op'>?</span> <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_remote_doc'>remote_doc</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_remote_doc'>remote_doc</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>IOError</span><span class='comma'>,</span> <span class='const'>MultiJson</span><span class='op'>::</span><span class='const'>ParseError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../../JSON.html" title="JSON (module)">JSON</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LD.html" title="JSON::LD (module)">LD</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="serializer-class_method">
  
    .<strong>serializer</strong>(object, *_args, **options)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The default serializer for serialzing Ruby Objects to JSON.</p>

<p>Defaults to <code>MultiJson.dump</code></p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>object</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>other arguments that may be passed for some specific implementation.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol, Object&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>options passed from the invoking context.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:serializer_opts</span>
          <span class="type">(<tt>Object</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>JSON_STATE</tt>
            
          </span>
          
        </li>
      
    </ul>
  


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


872
873
874
875</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 872</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_serializer'>serializer</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid__args'>_args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_serializer_opts'>serializer_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:serializer_opts</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../LD.html#JSON_STATE-constant" title="JSON::LD::JSON_STATE (constant)">JSON_STATE</a></span></span><span class='rparen'>)</span>
  <span class='const'>MultiJson</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='id identifier rubyid_serializer_opts'>serializer_opts</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="toRdf-class_method">
  
    .<strong>toRdf</strong>(input, expanded: false, **options) {|statement| ... } &#x21d2; <tt>RDF::Enumerable</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='toRDF-class_method'>toRDF</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Processes the input according to the RDF Conversion Algorithm, calling the provided callback for each triple generated.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The JSON-LD object to process when outputting statements.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>expanded</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>(false) Input is already expanded</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>options</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>**options</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:produceGeneralizedRdf</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If true, output will include statements having blank node predicates, otherwise they are dropped.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:adapter</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>used with MultiJson</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:base</span>
          <span class="type">(<tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>, <tt>String</tt>, <tt>#to_s</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The Base IRI to use when expanding the document. This overrides the value of <code>input</code> if it is a <em>IRI</em>. If not specified and <code>input</code> is not an <em>IRI</em>, the base IRI defaults to the current document IRI if in a browser context, or the empty string if there is no document context. If not specified, and a base IRI is found from <code>input</code>, <a href=":base">options</a> will be modified with this value.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactArrays</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to <code>true</code>, the JSON-LD processor replaces arrays with just one element with that element during compaction. If set to <code>false</code>, all arrays will remain arrays even if they have just one element.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:compactToRelative</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Creates document relative IRIs when compacting, if <code>true</code>, otherwise leaves expanded.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:documentLoader</span>
          <span class="type">(<tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The callback of the loader to be used to retrieve remote documents and contexts. If specified, it must be used to retrieve remote documents and contexts; otherwise, if not specified, the processorâ€™s built-in loader must be used. See <span class='object_link'><a href="#documentLoader-class_method" title="JSON::LD::API.documentLoader (method)">documentLoader</a></span> for the method signature.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:expandContext</span>
          <span class="type">(<tt>String</tt>, <tt>#read</tt>, <tt>Hash</tt>, <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>, <tt><span class='object_link'><a href="Context.html" title="JSON::LD::Context (class)">JSON::LD::Context</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>A context that is used to initialize the active context when expanding a document.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extendedRepresentation</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use the extended internal representation.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:extractAllScripts</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set, when given an HTML input without a fragment identifier, extracts all <code>script</code> elements with type <code>application/ld+json</code> into an array during expansion.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:flatten</span>
          <span class="type">(<tt>Boolean</tt>, <tt>String</tt>, <tt><span class='object_link'><a href="../../RDF/URI.html" title="RDF::URI (class)">RDF::URI</a></span></tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>If set to a value that is not <code>false</code>, the JSON-LD processor must modify the output of the Compaction Algorithm or the Expansion Algorithm by coalescing all properties associated with each subject via the Flattening Algorithm. The value of <code>flatten must</code> be either an <em>IRI</em> value representing the name of the graph to flatten, or <code>true</code>. If the value is <code>true</code>, then the first graph encountered in the input document is selected and flattened.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:language</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>When set, this has the effect of inserting a context definition with <code>@language</code> set to the associated value, creating a default language for interpreting string values.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:library</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>One of :nokogiri or :rexml. If nil/unspecified uses :nokogiri if available, :rexml otherwise.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:lowercaseLanguage</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>By default, language tags are left as is. To normalize to lowercase, set this option to <code>true</code>.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:ordered</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Order traversal of dictionary members by key when performing algorithms.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:processingMode</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Processing mode, json-ld-1.0 or json-ld-1.1.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rdfstar</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>support parsing JSON-LD-star statement resources.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:rename_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>true</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Rename bnodes as part of expansion, or keep them the same.</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:unique_bnodes</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
              &mdash; default:
              <tt>false</tt>
            
          </span>
          
            &mdash; <div class='inline'>
<p>Use unique bnode identifiers, defaults to using the identifier which the node was originally initialized with (if any).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:validate</span>
          <span class="type">(<tt>Boolean</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>Validate input, if a string or readable object.</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>statement</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>statement</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RDF/Statement.html" title="RDF::Statement (class)">RDF::Statement</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>RDF::Enumerable</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>set of statements, unless a block is given.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 525</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_toRdf'>toRdf</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_extend'>extend</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../RDF.html" title="RDF (module)">RDF</a></span></span><span class='op'>::</span><span class='const'>Enumerable</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_toRdf'>toRdf</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='id identifier rubyid_expanded'>expanded</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_stmt'>stmt</span><span class='op'>|</span>
      <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_stmt'>stmt</span>
    <span class='kw'>end</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_results'>results</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>extractAllScripts:</span> <span class='kw'>true</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='comment'># Flatten input to simplify processing
</span>  <span class='id identifier rubyid_flattened_input'>flattened_input</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_flatten'><span class='object_link'><a href="#flatten-class_method" title="JSON::LD::API.flatten (method)">flatten</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>expanded:</span> <span class='id identifier rubyid_expanded'>expanded</span><span class='comma'>,</span> <span class='label'>ordered:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span>

  <span class='const'><span class='object_link'><a href="" title="JSON::LD::API (class)">API</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_flattened_input'>flattened_input</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_options'>options</span><span class='rparen'>)</span> <span class='kw'>do</span>
    <span class='comment'># 1) Perform the Expansion Algorithm on the JSON-LD input.
</span>    <span class='comment'>#    This removes any existing context to allow the given context to be cleanly applied.
</span>    <span class='comment'># log_debug(&quot;.toRdf&quot;) {&quot;flattened input: #{flattened_input.to_json(JSON_STATE) rescue &#39;malformed json&#39;}&quot;}
</span>
    <span class='comment'># Recurse through input
</span>    <span class='id identifier rubyid_flattened_input'>flattened_input</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_node'>node</span><span class='op'>|</span>
      <span class='id identifier rubyid_item_to_rdf'>item_to_rdf</span><span class='lparen'>(</span><span class='id identifier rubyid_node'>node</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_statement'>statement</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_statement'>statement</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span><span class='period'>.</span><span class='id identifier rubyid_node?'>node?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:produceGeneralizedRdf</span><span class='rbracket'>]</span>

        <span class='comment'># Drop invalid statements (other than IRIs)
</span>        <span class='kw'>unless</span> <span class='id identifier rubyid_statement'>statement</span><span class='period'>.</span><span class='id identifier rubyid_valid_extended?'>valid_extended?</span>
          <span class='comment'># log_debug(&quot;.toRdf&quot;) {&quot;drop invalid statement: #{statement.to_nquads}&quot;}
</span>          <span class='kw'>next</span>
        <span class='kw'>end</span>

        <span class='kw'>yield</span> <span class='id identifier rubyid_statement'>statement</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="validate_input-class_method">
  
    .<strong>validate_input</strong>(input, url:)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Validate JSON using JsonLint, if loaded</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


880
881
882
883
884
885
886
887
888
889
890</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/json/ld/api.rb', line 880</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_validate_input'>validate_input</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>url:</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='const'>JsonLint</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_jsonlint'>jsonlint</span> <span class='op'>=</span> <span class='const'>JsonLint</span><span class='op'>::</span><span class='const'>Linter</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_input'>input</span> <span class='op'>=</span> <span class='const'>StringIO</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:read</span><span class='rparen'>)</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_jsonlint'>jsonlint</span><span class='period'>.</span><span class='id identifier rubyid_check_stream'>check_stream</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="JsonLdError.html" title="JSON::LD::JsonLdError (class)">JsonLdError</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="JsonLdError/LoadingDocumentFailed.html" title="JSON::LD::JsonLdError::LoadingDocumentFailed (class)">LoadingDocumentFailed</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>url: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_url'>url</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_jsonlint'>jsonlint</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_input'>input</span><span class='period'>.</span><span class='id identifier rubyid_rewind'>rewind</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Dec  4 21:20:35 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.4).
</div>

    </div>
  </body>
</html>